<view class="container">
  <!-- æœç´¢æ  -->
  <view class="search-bar">
    <input
      class="search-input"
      placeholder="æœç´¢åˆä½œé¡µé¢"
      value="{{searchKeyword}}"
      bindinput="onSearchInput"
    />
  </view>

  <!-- é¡µé¢åˆ—è¡¨ -->
  <view class="page-list">
    <view
      wx:for="{{pages}}"
      wx:key="_id"
      class="page-card"
      bindtap="viewPageDetail"
      data-page="{{item}}"
    >
      <!-- å°é¢ -->
      <view class="page-cover">
        <image
          wx:if="{{item.cover_image}}"
          class="cover-image"
          src="{{item.cover_image}}"
          mode="aspectFill"
        />
        <view wx:else class="cover-placeholder">
          <text class="placeholder-icon">ğŸ¤</text>
        </view>

        <!-- çŠ¶æ€æ ‡ç­¾ -->
        <view wx:if="{{item.is_joined}}" class="status-tag joined">
          å·²åŠ å…¥
        </view>
        <view wx:elif="{{item.is_pending}}" class="status-tag pending">
          å¾…å®¡æ ¸
        </view>
      </view>

      <!-- é¡µé¢ä¿¡æ¯ -->
      <view class="page-info">
        <text class="page-name">{{item.page_name}}</text>
        <text class="page-desc">{{item.page_desc || 'æš‚æ— æè¿°'}}</text>

        <view class="page-meta">
          <text class="meta-item">ğŸ‘¥ {{item.member_count}}/{{item.max_members}}</text>
          <text class="meta-item">ğŸ“ {{item.article_count}}ç¯‡</text>
        </view>
      </view>

      <!-- æ“ä½œæŒ‰é’® -->
      <view class="page-actions">
        <button
          wx:if="{{!item.is_joined && !item.is_pending}}"
          class="action-btn join-btn"
          catchtap="applyToJoin"
          data-page="{{item}}"
        >
          ç”³è¯·åŠ å…¥
        </button>
        <button
          wx:elif="{{item.is_pending}}"
          class="action-btn pending-btn"
          catchtap="cancelApplication"
          data-page="{{item}}"
        >
          å–æ¶ˆç”³è¯·
        </button>
        <button
          wx:else
          class="action-btn joined-btn"
          catchtap="viewMyPage"
          data-page="{{item}}"
        >
          æŸ¥çœ‹è¯¦æƒ…
        </button>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view wx:if="{{pages.length === 0 && !loading}}" class="empty-state">
      <text class="empty-icon">ğŸ“­</text>
      <text class="empty-text">æš‚æ— åˆä½œé¡µé¢</text>
    </view>

    <!-- åŠ è½½çŠ¶æ€ -->
    <view wx:if="{{loading}}" class="loading-state">
      <text class="loading-text">åŠ è½½ä¸­...</text>
    </view>
  </view>
</view>
