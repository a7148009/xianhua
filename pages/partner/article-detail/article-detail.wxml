<!-- pages/partner/article-detail/article-detail.wxml -->
<view class="container">
  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading-container">
    <view class="loading-text">åŠ è½½ä¸­...</view>
  </view>

  <!-- æ–‡ç« å†…å®¹ - å®Œå…¨ç…§æ¬æ›´å¤šé¡µé¢æ ·å¼ -->
  <view wx:if="{{!loading && article}}" class="article-container">
    <!-- æ–‡ç« å¡ç‰‡ -->
    <view class="info-item">
      <!-- æ ‡é¢˜è¡Œ -->
      <view class="info-title">
        <text class="info-number">{{article.default_sort}}</text>
        <text class="info-name">{{article.title}}</text>
      </view>

      <!-- æ–‡ç« å†…å®¹ -->
      <view class="info-detail">{{article.content}}</view>

      <!-- åº•éƒ¨ä¿¡æ¯ -->
      <view class="info-detail" style="margin-top: 20rpx; color: #999;">
        {{formatDate(article.publish_time)}} Â· ğŸ‘ {{article.view_count}} Â· â¤ï¸ {{article.like_count}}
      </view>
    </view>

    <!-- ç»Ÿè®¡ä¿¡æ¯ -->
    <view class="stats-card">
      <view class="stats-title">æ•°æ®ç»Ÿè®¡</view>
      <view class="stats-grid">
        <view class="stat-item">
          <text class="stat-value">{{article.view_count || 0}}</text>
          <text class="stat-label">æµè§ˆ</text>
        </view>
        <view class="stat-item">
          <text class="stat-value">{{article.like_count || 0}}</text>
          <text class="stat-label">ç‚¹èµ</text>
        </view>
        <view class="stat-item">
          <text class="stat-value">{{article.share_count || 0}}</text>
          <text class="stat-label">åˆ†äº«</text>
        </view>
        <view wx:if="{{article.publish_type === 'partner'}}" class="stat-item">
          <text class="stat-value {{article.is_score_sufficient ? 'sufficient' : 'insufficient'}}">
            {{article.promotion_score || 0}}
          </text>
          <text class="stat-label">ç§¯åˆ†</text>
        </view>
      </view>
    </view>

    <!-- æ‰€æœ‰è€…æ“ä½œæŒ‰é’® -->
    <view wx:if="{{isOwner}}" class="owner-actions">
      <button class="action-btn stats-btn" bindtap="viewStats">
        ğŸ“Š æŸ¥çœ‹è¯¦ç»†ç»Ÿè®¡
      </button>
      <button class="action-btn edit-btn" bindtap="editArticle">
        âœï¸ ç¼–è¾‘æ–‡ç« 
      </button>
      <button class="action-btn delete-btn" bindtap="deleteArticle">
        ğŸ—‘ï¸ åˆ é™¤æ–‡ç« 
      </button>
    </view>

    <!-- è®¿å®¢æ“ä½œæŒ‰é’® -->
    <view wx:if="{{!isOwner}}" class="visitor-actions">
      <button class="action-btn like-btn" bindtap="handleLike">
        â¤ï¸ ç‚¹èµ {{article.like_count > 0 ? article.like_count : ''}}
      </button>
      <button class="action-btn share-btn" open-type="share">
        ğŸ”— åˆ†äº«
      </button>
    </view>
  </view>
</view>
