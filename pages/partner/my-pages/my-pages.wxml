<view class="container">
  <!-- 统计卡片 -->
  <view class="stats-card">
    <view class="stat-item">
      <text class="stat-value">{{pages.length}}</text>
      <text class="stat-label">加入的页面</text>
    </view>
    <view class="stat-item">
      <text class="stat-value">{{totalArticles}}</text>
      <text class="stat-label">发布的文章</text>
    </view>
  </view>

  <!-- 页面列表 -->
  <view class="page-list">
    <view
      wx:for="{{pages}}"
      wx:key="_id"
      class="page-card"
      bindtap="viewPageDetail"
      data-page="{{item}}"
    >
      <!-- 封面 -->
      <view class="page-cover">
        <image
          wx:if="{{item.cover_image}}"
          class="cover-image"
          src="{{item.cover_image}}"
          mode="aspectFill"
        />
        <view wx:else class="cover-placeholder">
          <text class="placeholder-icon">🤝</text>
        </view>

        <!-- 角色标签 -->
        <view class="role-tag role-{{item.my_role}}">
          {{item.my_role === 'moderator' ? '管理员' : '成员'}}
        </view>
      </view>

      <!-- 页面信息 -->
      <view class="page-info">
        <text class="page-name">{{item.page_name}}</text>
        <text class="page-desc">{{item.page_desc || '暂无描述'}}</text>

        <view class="my-stats">
          <text class="stats-item">📝 我发布了 {{item.my_published_count}} 篇</text>
          <text class="stats-item">📅 {{formatDate(item.my_join_time)}}</text>
        </view>

        <view class="page-meta">
          <text class="meta-item">👥 成员: {{item.member_count}}/{{item.max_members}}</text>
          <text class="meta-item">📄 文章: {{item.article_count}}篇</text>
        </view>
      </view>

      <!-- 操作按钮 -->
      <view class="page-actions">
        <button
          class="action-btn publish-btn"
          catchtap="publishArticle"
          data-page="{{item}}"
        >
          发布文章
        </button>
        <button
          class="action-btn quit-btn"
          catchtap="quitPage"
          data-page="{{item}}"
        >
          退出页面
        </button>
      </view>
    </view>

    <!-- 空状态 -->
    <view wx:if="{{pages.length === 0 && !loading}}" class="empty-state">
      <text class="empty-icon">📭</text>
      <text class="empty-text">您还没有加入任何合作页面</text>
      <button class="empty-btn" bindtap="browsePage">浏览合作页面</button>
    </view>

    <!-- 加载状态 -->
    <view wx:if="{{loading}}" class="loading-state">
      <text class="loading-text">加载中...</text>
    </view>
  </view>
</view>
