<view class="container">
  <!-- ç”¨æˆ·ä¿¡æ¯åŒºåŸŸ -->
  <view class="user-section">
    <!-- æœªç™»å½•çŠ¶æ€ -->
    <view wx:if="{{!isLoggedIn}}" class="login-area" bindtap="wxLogin">
      <view class="avatar-placeholder">ğŸ‘¤</view>
      <view class="login-info">
        <text class="login-text">ç‚¹å‡»ç™»å½•</text>
        <text class="login-desc">ç™»å½•åäº«å—æ›´å¤šæœåŠ¡</text>
      </view>
      <view class="login-arrow">></view>
    </view>

    <!-- å·²ç™»å½•çŠ¶æ€ -->
    <view wx:else class="user-info-wrapper">
      <view class="user-info-row">
        <view class="user-avatar-wrapper">
          <image class="user-avatar" src="{{userInfo.avatarUrl}}" mode="aspectFill" binderror="onAvatarError" />
        </view>
        <view class="user-details">
          <view class="user-name-row">
            <text class="user-name">{{userInfo.nickName || 'å¾®ä¿¡ç”¨æˆ·'}}</text>
          </view>
          <text class="user-desc">
            {{userInfo.role === 'vip' && userInfo.vipExpireDate ? 'VIPè‡³' + formatVipExpireDate(userInfo.vipExpireDate) : 'å·²ç™»å½•ï¼Œäº«å—å®Œæ•´æœåŠ¡'}}
          </text>
          <!-- ç§»é™¤OpenIDæ˜¾ç¤ºï¼Œåªåœ¨è°ƒè¯•æ¨¡å¼ä¸‹æ˜¾ç¤º -->
          <text class="debug-info" wx:if="{{showDebug}}">è°ƒè¯•ä¿¡æ¯: OpenID: {{userInfo.openid || 'æœªè·å–'}}</text>
        </view>
      </view>
      <view class="user-actions">
        <button class="edit-btn" bindtap="updateProfile">ç¼–è¾‘</button>
        <button class="logout-btn" bindtap="logout">é€€å‡º</button>
      </view>
    </view>
  </view>

  <!-- èœå•åˆ—è¡¨ -->
  <view class="menu-section">
    <view
      wx:for="{{menuItems}}"
      wx:key="title"
      class="menu-item"
      data-item="{{item}}"
      bindtap="onMenuTap"
    >
      <view class="menu-icon">{{item.icon}}</view>
      <view class="menu-content">
        <text class="menu-title">{{item.title}}</text>
        <text class="menu-desc">{{item.desc}}</text>
      </view>
      <view class="menu-arrow">></view>
    </view>
  </view>

  <!-- è°ƒè¯•å·¥å…·ï¼ˆä»…ç®¡ç†å‘˜å¯è§ï¼‰ -->
  <view wx:if="{{showDebug && userInfo && userInfo.role === 'admin'}}" class="debug-section">
    <view class="debug-title">ğŸ”§ ç®¡ç†å‘˜è°ƒè¯•å·¥å…·</view>
    <button class="debug-btn" bindtap="diagnoseVIP">ğŸ” è¯Šæ–­VIPçŠ¶æ€</button>
    <button class="debug-btn" bindtap="initializeVariables">åˆå§‹åŒ–ç³»ç»Ÿå˜é‡</button>
    <button class="debug-btn" bindtap="copyOpenId">å¤åˆ¶OpenID</button>
  </view>

  <!-- ç‰ˆæœ¬ä¿¡æ¯ -->
  <view class="version-info" bindtap="onTitleTap">
    <text class="version-text">é²œèŠ±å‘å¸ƒç³»ç»Ÿ v1.0.0</text>
  </view>
</view>
